document.addEventListener('deviceready', onDeviceReady, false);

function onDeviceReady() {
    // Cordova is now initialized. Have fun!
    // isBtConnected();
}

// local storage
var localStorage = window.localStorage;

var dot = document.getElementById('dot');
var isBtDeviceConnected = false;

function isBtConnected() {
    setInterval(function () {
        //this code runs every second
        bluetoothSerial.isConnected(isBtConnectedSuccess, isBtConnectedFailure);
    }, 1000);

}

function isBtConnectedSuccess() {
    dot.style.backgroundColor = "#1cff00 ";
    isBtDeviceConnected = true;
    // console.log("[btEasy]", "Device is definitly Connected succesfull");
    return true;
}

function isBtConnectedFailure() {
    dot.style.backgroundColor = "red";
    isBtDeviceConnected = false;
    // console.log("[btEasy]","device not connected!!");
    return false;
}

function sendColorToBT() {
    //colorString is format of:
    //['{"red":RED,"green":GREEN,"blue":BLUE,}]'
    //can be generated by myOwnTypeOfStringify()
    if (localStorage !== null && localStorage.getItem("rgbStringToSend")) {
        var colorString = localStorage.getItem("rgbStringToSend");
        console.log("[btEasy]", colorString);
        bluetoothSerial.write(colorString, sendSuccess, sendFailure);
    } else {
        sendFailure("There is no LOCAL storage to send", "rgbStringToSend");
    }

}

function sendSuccess() {
    console.log("[sendColor]", "SUCCESS");

}
function sendFailure(e) {
    console.log("[sendColor]", "failed!!", e);
}